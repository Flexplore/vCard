<!doctype html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Florian Fournier • Flexplore</title>
    <meta name="description" content="Carte de visite : enregistrer le contact, réserver une consultation." />
    <meta name="theme-color" content="#060b18" />

    <link rel="stylesheet" href="./styles.css" />

    <!-- Spline: loader conditionnel + preload scène -->
    <script>
      (function () {
        const SCENE_URL =
          "https://prod.spline.design/HDyWmhB2pMKQXwE8/scene.splinecode?v=20251003-2";

        const prefersReducedMotion = window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches;
        const lowCpu = (navigator.hardwareConcurrency && navigator.hardwareConcurrency <= 4) ||
                       (navigator.deviceMemory && navigator.deviceMemory <= 4);
        const saveData = navigator.connection?.saveData === true;
        const effectiveType = navigator.connection?.effectiveType || "";
        const slowNetwork = ["slow-2g", "2g"].includes(effectiveType);

        const shouldEnableSpline = !(prefersReducedMotion || lowCpu || saveData || slowNetwork);

        // Expose pour main.js
        window.__SPLINE_SCENE_URL__ = SCENE_URL;
        window.__ENABLE_SPLINE__ = shouldEnableSpline;

        if (shouldEnableSpline) {
          // preload lib
          const preload = document.createElement("link");
          preload.rel = "modulepreload";
          preload.href = "https://unpkg.com/@splinetool/viewer@1/build/spline-viewer.js";
          preload.crossOrigin = "anonymous";
          preload.fetchPriority = "high";
          document.head.appendChild(preload);

          // preload scène
          const splineFetch = document.createElement("link");
          splineFetch.rel = "preload";
          splineFetch.as = "fetch";
          splineFetch.href = SCENE_URL;
          splineFetch.crossOrigin = "anonymous";
          splineFetch.fetchPriority = "high";
          document.head.appendChild(splineFetch);

          // load lib
          const script = document.createElement("script");
          script.type = "module";
          script.src = "https://unpkg.com/@splinetool/viewer@1/build/spline-viewer.js";
          script.dataset.splineLoader = "true";
          document.head.appendChild(script);

          // warm fetch
          fetch(SCENE_URL, { mode: "cors" }).catch(() => {});
        }
      })();
    </script>
  </head>

  <body>
    <!-- Préchargement / instanciation du robot (hors écran) -->
    <div
      id="spline-preload"
      style="position: fixed; left: -9999px; top: -9999px; width: 1px; height: 1px; overflow: hidden;"
      aria-hidden="true"
    >
      <!-- On le déplace ensuite dans la zone visible via main.js -->
      <spline-viewer
        id="spline-boot"
        url="https://prod.spline.design/HDyWmhB2pMKQXwE8/scene.splinecode?v=20251003-2"
      ></spline-viewer>
    </div>

    <main class="screen">
      <header class="top">
        <div class="brand">
          <div class="mark" aria-hidden="true">
            <svg width="26" height="26" viewBox="0 0 24 24" fill="none">
              <path
                d="M12 2.5c2.2 0 4 1.8 4 4 0 .6-.1 1.1-.3 1.6 2.4.8 4.3 3.1 4.3 5.9 0 3.5-2.8 6.3-6.3 6.3H10.3C6.8 20.3 4 17.5 4 14c0-2.8 1.9-5.1 4.3-5.9-.2-.5-.3-1-.3-1.6 0-2.2 1.8-4 4-4Z"
                stroke="currentColor"
                stroke-width="1.6"
                opacity=".9"
              />
              <path
                d="M9.2 13.7c.7-1.3 2-2.2 3.5-2.2 1.8 0 3.3 1.2 3.8 2.9"
                stroke="currentColor"
                stroke-width="1.6"
                stroke-linecap="round"
              />
            </svg>
          </div>
          <div class="brandText">
            <div class="brandName">Flexplore</div>
          </div>
        </div>
      </header>

      <section class="hero">
        <div class="robotShell" aria-label="Robot Flexplore">
          <div class="ring" aria-hidden="true"></div>

          <!-- Zone visible: le spline-viewer est injecté ici -->
          <div id="robotStage" class="robotStage">
            <div id="robotFallback" class="robotFallback" aria-hidden="true"></div>
          </div>
        </div>

        <h1 id="fullName" class="name">Florian Fournier</h1>
        <p id="tagline" class="subtitle">Expert en IA & Automatisation</p>

        <div class="ctaRow">
          <button id="btnAddContact" class="btn outline" type="button">
            <span class="btnIcon" aria-hidden="true">
              <svg viewBox="0 0 24 24" width="20" height="20" fill="none">
                <path d="M12 3v10" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"/>
                <path d="M8.5 10.5 12 13.9l3.5-3.4" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M6.5 16.5h11" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"/>
              </svg>
            </span>
            Enregistrer contact
          </button>

          <a id="btnCalendly" class="btn primary" href="#" target="_blank" rel="noreferrer">
            <span class="btnIcon" aria-hidden="true">
              <svg viewBox="0 0 24 24" width="20" height="20" fill="none">
                <path d="M7 3.5v3M17 3.5v3" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"/>
                <path d="M4.5 8.2h15" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"/>
                <path d="M6.5 5.8h11c1.1 0 2 .9 2 2v11.2c0 1.1-.9 2-2 2h-11c-1.1 0-2-.9-2-2V7.8c0-1.1.9-2 2-2Z" stroke="currentColor" stroke-width="1.8"/>
              </svg>
            </span>
            Réserver ma consultation
          </a>
        </div>

        <div class="singleAction">
          <a id="btnWebsite" class="circleBtn" href="#" target="_blank" rel="noreferrer" aria-label="Site web">
            <svg viewBox="0 0 24 24" width="22" height="22" fill="none" aria-hidden="true">
              <path d="M12 21a9 9 0 1 0 0-18 9 9 0 0 0 0 18Z" stroke="currentColor" stroke-width="1.8"/>
              <path d="M3.5 12h17" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"/>
              <path d="M12 3c2.6 2.6 2.6 15.4 0 18-2.6-2.6-2.6-15.4 0-18Z" stroke="currentColor" stroke-width="1.8" stroke-linejoin="round"/>
            </svg>
          </a>
        </div>
      </section>

      <footer class="foot">
        <span id="footNote">© <span id="year"></span> Flexplore</span>
      </footer>
    </main>

    <script src="./main.js"></script>
  </body>
</html>
